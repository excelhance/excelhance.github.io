<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lâ€™Archiviste</title>

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    }

    body {
      background: #0f172a;
      color: #e5e7eb;
      padding: 16px;
    }

    h1 {
      text-align: center;
      margin-bottom: 16px;
      font-size: 1.6rem;
    }

    button {
      width: 100%;
      padding: 12px;
      margin-bottom: 16px;
      border: none;
      border-radius: 10px;
      background: #38bdf8;
      color: #0f172a;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
    }

    .zone {
      border: 2px dashed #475569;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 20px;
    }

    .zone-title {
      text-align: center;
      margin-bottom: 8px;
      font-size: 1rem;
      color: #94a3b8;
    }

    .cartes {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      min-height: 110px;
    }

    .carte {
      width: 70px;
      height: 100px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.4);
      color: black;
      position: relative;
      user-select: none;
      cursor: pointer;
      transition: transform 0.1s ease;
      touch-action: manipulation;
    }

    .carte.rouge {
      color: #b91c1c;
    }

    .carte.selectionnee {
      outline: 3px solid #38bdf8;
      transform: translateY(-6px);
    }

    .valeur {
      position: absolute;
      top: 6px;
      left: 6px;
      font-size: 0.9rem;
      font-weight: bold;
    }

    .symbole {
      position: absolute;
      bottom: 6px;
      right: 6px;
      font-size: 0.9rem;
    }

    .centre {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2rem;
    }

    /* ARCHIVES */
    .archives {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }

    .archive {
      border: 2px solid #475569;
      border-radius: 10px;
      padding: 6px;
      text-align: center;
      cursor: pointer;
    }

    .archive h3 {
      margin-bottom: 6px;
    }

    .archive-cartes {
      min-height: 90px;
    }
  </style>
</head>

<body>

  <h1>ðŸ‚¡ Lâ€™Archiviste</h1>

  <button id="piocherBtn">Piocher (2 cartes)</button>

  <!-- ZONE CENTRALE -->
  <div class="zone">
    <div class="zone-title">Zone Centrale</div>
    <div class="cartes" id="zoneCentrale"></div>
  </div>

  <!-- ARCHIVES -->
  <div class="zone">
    <div class="zone-title">Archives</div>
    <div class="archives">
      <div class="archive" data-couleur="â™ ">
        <h3>â™ </h3>
        <div class="archive-cartes"></div>
      </div>
      <div class="archive" data-couleur="â™¥">
        <h3>â™¥</h3>
        <div class="archive-cartes"></div>
      </div>
      <div class="archive" data-couleur="â™¦">
        <h3>â™¦</h3>
        <div class="archive-cartes"></div>
      </div>
      <div class="archive" data-couleur="â™£">
        <h3>â™£</h3>
        <div class="archive-cartes"></div>
      </div>
    </div>
  </div>

  <script>
    /* ===== Ã‰TAT DU JEU ===== */

    let pioche = [];
    const zoneCentrale = document.getElementById('zoneCentrale');
    const piocherBtn = document.getElementById('piocherBtn');

    const archives = {
      'â™ ': [],
      'â™¥': [],
      'â™¦': [],
      'â™£': []
    };

    const couleurs = ['â™ ', 'â™¥', 'â™¦', 'â™£'];
    const valeurs = [
      { label: 'A', valeur: 1 },
      { label: '2', valeur: 2 },
      { label: '3', valeur: 3 },
      { label: '4', valeur: 4 },
      { label: '5', valeur: 5 },
      { label: '6', valeur: 6 },
      { label: '7', valeur: 7 },
      { label: '8', valeur: 8 },
      { label: '9', valeur: 9 },
      { label: '10', valeur: 10 },
      { label: 'D', valeur: 12 },
      { label: 'R', valeur: 13 }
    ];

    /* ===== INITIALISATION ===== */

    function creerPaquet() {
      pioche = [];
      couleurs.forEach(couleur => {
        valeurs.forEach(v => {
          pioche.push({
            label: v.label,
            valeur: v.valeur,
            couleur: couleur
          });
        });
      });
      melanger(pioche);
    }

    function melanger(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    /* ===== CRÃ‰ATION CARTE ===== */

    function creerCarteHTML(carte) {
      const div = document.createElement('div');
      div.classList.add('carte');
      if (carte.couleur === 'â™¥' || carte.couleur === 'â™¦') {
        div.classList.add('rouge');
      }

      div.dataset.valeur = carte.valeur;
      div.dataset.couleur = carte.couleur;

      div.innerHTML = `
        <div class="valeur">${carte.label}</div>
        <div class="centre">${carte.couleur}</div>
        <div class="symbole">${carte.couleur}</div>
      `;

      const toggle = (e) => {
        e.preventDefault();
        div.classList.toggle('selectionnee');
      };

      div.addEventListener('click', toggle);
      div.addEventListener('touchstart', toggle);

      return div;
    }

    /* ===== PIOCHER ===== */

    function piocherCartes() {
      for (let i = 0; i < 2; i++) {
        if (pioche.length === 0) return;
        const carte = pioche.pop();
        zoneCentrale.appendChild(creerCarteHTML(carte));
      }
    }

    piocherBtn.addEventListener('click', piocherCartes);

    /* ===== CLASSER ===== */

    document.querySelectorAll('.archive').forEach(archiveDiv => {
      archiveDiv.addEventListener('click', () => {
        const selection = document.querySelectorAll('.carte.selectionnee');
        if (selection.length !== 1) return;

        const carteDiv = selection[0];
        const couleurArchive = archiveDiv.dataset.couleur;

        if (carteDiv.dataset.couleur !== couleurArchive) return;

        const valeurCarte = parseInt(carteDiv.dataset.valeur, 10);
        const pile = archives[couleurArchive];
        const derniereValeur = pile.length === 0 ? 0 : pile[pile.length - 1];

        if (valeurCarte !== derniereValeur + 1) return;

        // Classement
        pile.push(valeurCarte);
        archiveDiv.querySelector('.archive-cartes').appendChild(carteDiv);
        carteDiv.classList.remove('selectionnee');
      });
    });

    /* ===== LANCEMENT ===== */

    creerPaquet();
  </script>

</body>
</html>
