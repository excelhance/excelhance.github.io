<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>L‚ÄôArchiviste</title>

<style>
body{background:#0f172a;color:#e5e7eb;padding:16px;font-family:system-ui}
h1{text-align:center;margin-bottom:10px}
button{width:100%;padding:12px;margin-bottom:8px;border:none;border-radius:10px;background:#38bdf8;color:#0f172a;font-weight:bold}
.zone{border:2px dashed #475569;border-radius:12px;padding:10px;margin-bottom:14px}
.zone-title{text-align:center;margin-bottom:6px;color:#94a3b8}
.cartes{display:flex;gap:8px;flex-wrap:wrap;justify-content:center;min-height:110px}

.carte{width:70px;height:100px;background:#fff;border-radius:10px;color:#000;position:relative;box-shadow:0 4px 8px rgba(0,0,0,.4)}
.carte.rouge{color:#b91c1c}
.carte.selectionnee{outline:3px solid #38bdf8;transform:translateY(-6px)}

.valeur{position:absolute;top:6px;left:6px;font-weight:bold}
.centre{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:2rem}

.archives{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.archive{border:2px solid #475569;border-radius:10px;padding:6px;position:relative}
.archive h3{text-align:center;margin-bottom:4px}

.archive-cartes{position:relative}
.archive-cartes .carte{position:absolute;left:0}

.joker-marqueur{
  position:absolute;
  top:-14px;
  right:4px;
  font-size:1.2rem;
}
</style>
</head>

<body>

<h1>üÇ° L‚ÄôArchiviste</h1>

<button id="piocher">Piocher (2)</button>
<button id="defausser">D√©fausser</button>
<button id="joker">Activer Joker</button>

<div class="zone">
  <div class="zone-title">Zone Centrale</div>
  <div class="cartes" id="centre"></div>
</div>

<div class="zone">
  <div class="zone-title">Archives</div>
  <div class="archives">
    <div class="archive" data-c="‚ô†"><h3>‚ô†</h3><div class="archive-cartes"></div></div>
    <div class="archive" data-c="‚ô•"><h3 style="color:#b91c1c">‚ô•</h3><div class="archive-cartes"></div></div>
    <div class="archive" data-c="‚ô¶"><h3 style="color:#b91c1c">‚ô¶</h3><div class="archive-cartes"></div></div>
    <div class="archive" data-c="‚ô£"><h3>‚ô£</h3><div class="archive-cartes"></div></div>
  </div>
</div>

<script>
const centre=document.getElementById("centre");
let pioche=[],etat="pioche",jokerUtilise=false;
let archives={"‚ô†":[], "‚ô•":[], "‚ô¶":[], "‚ô£":[]};

const valeurs=[["A",1],["2",2],["3",3],["4",4],["5",5],["6",6],["7",7],["8",8],["9",9],["10",10],["D",12],["R",13]];
const couleurs=["‚ô†","‚ô•","‚ô¶","‚ô£"];

function creerPaquet(){
  pioche=[];
  couleurs.forEach(c=>valeurs.forEach(v=>pioche.push({l:v[0],v:v[1],c})));
  pioche.sort(()=>Math.random()-.5);
}

function carteHTML(c,interactive=true){
  const d=document.createElement("div");
  d.className="carte"+((c.c=="‚ô•"||c.c=="‚ô¶")?" rouge":"");
  d.innerHTML=`<div class=valeur>${c.l}</div><div class=centre>${c.c}</div>`;
  if(interactive){
    d.onclick=()=>d.classList.toggle("selectionnee");
  }
  d.dataset.v=c.v; d.dataset.c=c.c;
  return d;
}

document.getElementById("piocher").onclick=()=>{
  if(etat!=="pioche") return;
  for(let i=0;i<2;i++) if(pioche.length) centre.appendChild(carteHTML(pioche.pop()));
  etat="action";
};

document.querySelectorAll(".archive").forEach(a=>{
  a.onclick=()=>{
    if(etat!=="action") return;
    const sel=[...document.querySelectorAll(".carte.selectionnee")];
    if(sel.length!==1) return;
    const d=sel[0];
    if(d.dataset.c!==a.dataset.c) return;

    archives[a.dataset.c].push({v:+d.dataset.v,l:d.querySelector(".valeur").textContent,c:d.dataset.c});
    d.remove();
    renderArchive(a.dataset.c);
    etat="pioche";
    verifierVictoire();
  };
});

function renderArchive(c){
  const cont=document.querySelector(`.archive[data-c="${c}"] .archive-cartes`);
  cont.innerHTML="";
  archives[c].sort((a,b)=>a.v-b.v).forEach((carte,i)=>{
    const d=carteHTML(carte,false);
    d.style.top=(i*10)+"px";
    cont.appendChild(d);
  });
  cont.style.height=(archives[c].length*10+100)+"px";
}

document.getElementById("defausser").onclick=()=>{
  if(etat!=="action") return;
  const sel=[...document.querySelectorAll(".carte.selectionnee")];
  if(sel.length===2){
    const v=sel.map(c=>+c.dataset.v);
    if(v[0]===v[1]){ sel.forEach(c=>c.remove()); etat="pioche"; }
  }
};

document.getElementById("joker").onclick=()=>{
  if(jokerUtilise){ alert("D√©faite ‚Äî Chaos incontr√¥l√©"); location.reload(); }
  jokerUtilise=true;

  const nonVides=couleurs.filter(c=>archives[c].length);
  if(!nonVides.length) return;
  const c=nonVides[Math.floor(Math.random()*nonVides.length)];

  pioche.push(...archives[c]);
  archives[c]=[];
  renderArchive(c);

  const a=document.querySelector(`.archive[data-c="${c}"]`);
  a.insertAdjacentHTML("beforeend","<div class='joker-marqueur'>üÉè</div>");
};

function verifierVictoire(){
  couleurs.forEach(c=>{
    if(archives[c].length===10) alert("Victoire üèÜ Archive stabilis√©e");
  });
}

creerPaquet();
</script>

</body>
</html>
